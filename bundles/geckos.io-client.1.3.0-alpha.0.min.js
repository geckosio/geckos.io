var geckos=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EVENTS={SEND_OVER_DATA_CHANNEL:"sendOverDataChannel",RECEIVED_FROM_DATA_CHANNEL:"receiveFromDataChannel",DISCONNECTED:"disconnected",DISCONNECT:"disconnect",CONNECTION:"connection",CONNECT:"connect",ERROR:"error",DATA_CHANNEL_IS_OPEN:"dataChannelIsOpen",RAW_MESSAGE:"rawMessage"};t.ERRORS={BROWSER_NOT_SUPPORTED:"BROWSER_NOT_SUPPORTED",COULD_NOT_PARSE_MESSAGE:"COULD_NOT_PARSE_MESSAGE"}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(5)),i=function(){function e(){this.eventEmitter=new o.default}return e.prototype.emit=function(e,t,n){void 0===n&&(n={}),this.eventEmitter.emit(e,t,n)},e.prototype.on=function(e,t){return this.eventEmitter.on(e,(function(e,n){t(e,n)}))},e.prototype.removeListener=function(e,t,n){void 0===n&&(n=void 0),this.eventEmitter.removeListener(e,t,n)},e}();t.Bridge=i;var a=new i;t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);t.isRawMessage=function(e){return"string"==typeof e||e instanceof ArrayBuffer||e instanceof r.ArrayBufferView};t.isObject=function(e){return"object"==typeof e};t.isJSONString=function(e){try{return"string"==typeof e&&(!!isNaN(parseInt(e))&&(JSON.parse(e),!0))}catch(e){return!1}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(4));t.default=o.default},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(1)),c=n(6),s=n(0),u=i(n(9)),l=i(n(10)),f=function(){function e(e,t,n,r){this.receivedReliableMessages=[],this.url=e+":"+t,this.connectionsManager=new l.default(this.url,n,r)}return e.prototype.onconnectionstatechange=function(){var e=this.peerConnection.localPeerConnection;e.onconnectionstatechange=function(){"disconnected"!==e.connectionState&&"closed"!==e.connectionState||a.default.emit(s.EVENTS.DISCONNECTED)}},Object.defineProperty(e.prototype,"id",{get:function(){return this.peerConnection.id},enumerable:!0,configurable:!0}),e.prototype.emit=function(e,t,n){var r=this;void 0===t&&(t=null),n&&n.reliable?c.makeReliable(n,(function(n){return r.connectionsManager.emit(e,{MESSAGE:t,RELIABLE:1,ID:n})})):this.connectionsManager.emit(e,t)},Object.defineProperty(e.prototype,"raw",{get:function(){var e=this;return{emit:function(t){return e.emit(s.EVENTS.RAW_MESSAGE,t)}}},enumerable:!0,configurable:!0}),e.prototype.onRaw=function(e){a.default.on(s.EVENTS.RAW_MESSAGE,(function(t){!function(t){e(t)}(t)}))},e.prototype.onConnect=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return a.default.on(s.EVENTS.DATA_CHANNEL_IS_OPEN,(function(){e()})),this.peerConnection=new u.default,[4,this.peerConnection.connect(this.connectionsManager)];case 1:return(t=n.sent())?e(t):this.onconnectionstatechange(),[2]}}))}))},e.prototype.onDisconnect=function(e){a.default.on(s.EVENTS.DISCONNECTED,e)},e.prototype.on=function(e,t){var n=this;a.default.on(e,(function(e){e&&void 0!==e.MESSAGE&&1===e.RELIABLE&&"undefined"!==e.ID?0===n.receivedReliableMessages.filter((function(t){return t.id===e.ID})).length&&(n.receivedReliableMessages.push({date:new Date,id:e.ID}),t(e.MESSAGE)):t(e)}))},e}();t.ClientChannel=f;t.default=function(e){void 0===e&&(e={});var t=e.iceServers,n=void 0===t?[]:t,r=e.iceTransportPolicy,o=void 0===r?"all":r,i=e.url,a=void 0===i?location.protocol+"//"+location.hostname:i,c=e.port,s=void 0===c?9208:c,u=e.label;return new f(a,s,void 0===u?"geckos.io":u,{iceServers:n,iceTransportPolicy:o})}},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o="~";function i(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function c(e,t,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var c=new a(n,r||e,i),s=o?o+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],c]:e._events[s].push(c):(e._events[s]=c,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),u.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(o?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},u.prototype.listeners=function(e){var t=o?o+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,a=new Array(i);r<i;r++)a[r]=n[r].fn;return a},u.prototype.listenerCount=function(e){var t=o?o+e:e,n=this._events[t];return n?n.fn?1:n.length:0},u.prototype.emit=function(e,t,n,r,i,a){var c=o?o+e:e;if(!this._events[c])return!1;var s,u,l=this._events[c],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,i),!0;case 6:return l.fn.call(l.context,t,n,r,i,a),!0}for(u=1,s=new Array(f-1);u<f;u++)s[u-1]=arguments[u];l.fn.apply(l.context,s)}else{var h,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),f){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,r);break;default:if(!s)for(h=1,s=new Array(f-1);h<f;h++)s[h-1]=arguments[h];l[u].fn.apply(l[u].context,s)}}return!0},u.prototype.on=function(e,t,n){return c(this,e,t,n,!1)},u.prototype.once=function(e,t,n){return c(this,e,t,n,!0)},u.prototype.removeListener=function(e,t,n,r){var i=o?o+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||s(this,i);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||r&&!a[c].once||n&&a[c].context!==n)&&u.push(a[c]);u.length?this._events[i]=1===u.length?u[0]:u:s(this,i)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=o,u.EventEmitter=u,e.exports=u},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(7)),i=r(n(8));t.makeReliable=function(e,t){var n=e.interval,r=void 0===n?150:n,a=e.runs,c=void 0===a?10:a,s=o.default(24);i.default(r,c,(function(){t(s)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){void 0===e&&(e=24);for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",r=0;r<e;r++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n){void 0===e&&(e=200),void 0===t&&(t=1),void 0===n&&(n=function(){console.error("Please add a callback function to runInterval()")});var r=0,o=setInterval((function(){n(),++r===t-1&&clearInterval(o)}),e);n()}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=function(){function e(){}return e.prototype.connect=function(e){return r(this,void 0,void 0,(function(){var t,n,r,a,c;return o(this,(function(o){switch(o.label){case 0:return RTCPeerConnection||webkitRTCPeerConnection||mozRTCPeerConnection?[4,e.connect()]:[3,2];case 1:return t=o.sent(),n=t.localPeerConnection,r=t.dataChannel,a=t.id,this.localPeerConnection=n,this.dataChannel=r,this.id=a,[2,null];case 2:return c=new Error(i.ERRORS.BROWSER_NOT_SUPPORTED),console.error(c.message),[2,c]}}))}))},e}();t.default=a},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(n(1)),s=n(0),u=a(n(11)),l=a(n(13)),f=function(){function e(e,t,n){var r=this;this.url=e,this.label=t,this.rtcConfiguration=n,this.onDataChannel=function(e){var t=e.channel;t.label===r.label&&(r.dataChannel=t,r.dataChannel.binaryType="arraybuffer",r.dataChannel.onmessage=function(e){var t=u.default(e),n=t.key,r=t.data;c.default.emit(n,r)},c.default.emit(s.EVENTS.DATA_CHANNEL_IS_OPEN))}}return e.prototype.emit=function(e,t){void 0===t&&(t=null),l.default(this.dataChannel,e,t)},e.prototype.connect=function(){return o(this,void 0,void 0,(function(){var e,t,n,o,a,c,s,u,l,f,h,p,d;return i(this,(function(i){switch(i.label){case 0:e=this.url+"/.wrtc/v1",i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(e+"/connections",{method:"POST",headers:{"Content-Type":"application/json"}})];case 2:return t=i.sent(),n=this,[4,t.json()];case 3:return n.remotePeerConnection=i.sent(),[3,5];case 4:return o=i.sent(),console.error(o.message),[3,5];case 5:a=this.remotePeerConnection,c=a.id,s=a.localDescription,u=r({sdpSemantics:"unified-plan"},this.rtcConfiguration),l=RTCPeerConnection||webkitRTCPeerConnection||mozRTCPeerConnection,this.localPeerConnection=new l(u),i.label=6;case 6:return i.trys.push([6,14,,15]),[4,this.localPeerConnection.setRemoteDescription(s)];case 7:return i.sent(),this.localPeerConnection.addEventListener("datachannel",this.onDataChannel),[4,this.localPeerConnection.createAnswer()];case 8:return f=i.sent(),h=new RTCSessionDescription({type:"answer",sdp:f.sdp}),[4,this.localPeerConnection.setLocalDescription(h)];case 9:i.sent(),i.label=10;case 10:return i.trys.push([10,12,,13]),[4,fetch(e+"/connections/"+c+"/remote-description",{method:"POST",body:JSON.stringify(this.localPeerConnection.localDescription),headers:{"Content-Type":"application/json"}})];case 11:return i.sent(),[3,13];case 12:return p=i.sent(),console.error(p.message),[3,13];case 13:return[2,{localPeerConnection:this.localPeerConnection,dataChannel:this.dataChannel,id:c}];case 14:throw d=i.sent(),console.error(d.message),this.localPeerConnection.close(),d;case 15:return[2]}}))}))},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(2);t.default=function(e){var t,n,i=e.data,a=o.isJSONString(i);return!a&&o.isRawMessage(i)?(t=r.EVENTS.RAW_MESSAGE,n=i):a?n=(i=JSON.parse(i))[t=Object.keys(i)[0]]:(t="error",n=new Error(r.ERRORS.COULD_NOT_PARSE_MESSAGE)),{key:t,data:n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor;t.ArrayBufferView=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),o=n(0);t.default=function(e,t,n){var i;if(void 0===n&&(n=null),"open"===e.readyState)try{t===o.EVENTS.RAW_MESSAGE&&null!==n&&r.isRawMessage(n)?e.send(n):e.send(JSON.stringify(((i={})[t]=n,i)))}catch(e){console.error("Error => dataChannel.send: ",e.message)}}}]).default;